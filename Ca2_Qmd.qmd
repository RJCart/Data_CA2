---
title: "Ca2"
author: "Ruth C"
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

```{r}


#Packages
library(DBI)
library(RSQLite)
library(odbc)
library(knitr)
library(ggplot2)

```

```{r}
#data
db_path <- "C:/Users/Ruth/Desktop/Ca1_RuthC/Data_CA2/ICA_2023.sqlite"
con <- dbConnect(RSQLite::SQLite(), dbname = "ICA_2023.sqlite")

```

```         
```

```{r}

#List names of tables

con <- dbConnect(SQLite(), dbname = "C:/Users/Ruth/Desktop/Ca1_RuthC/Data_CA2/ICA_2023.sqlite")

# List tables
tables <- dbListTables(con)

# Print their names
print(tables)

con <- dbConnect(SQLite(), dbname = "ICA_2023.sqlite")
```

```{sql connection=con}
SELECT 
    c.CustomerCountry AS country,
    SUM(p.budget) AS total_budget,
    COUNT(p.ProjectID) AS project_count
FROM 
    Customers c
JOIN 
    Projects p
ON 
    c.CustomerID = p.CustomerID
GROUP BY 
    c.CustomerCountry
ORDER BY 
    total_budget DESC;
```
